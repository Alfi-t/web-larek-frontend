# Проектная работа "Веб-ларек"

## Описание проекта 

Web-ларек - Интернет-магазин для веб-разработчиков. В нем можно:

- Просматривать каталог товаров
- Добавлять товары в корзину и оформлять  заказ
- Выбирать способ оплаты и вводить данные для доставки

## Используемый стек:
HTML, SCSS, TS, Webpack

## Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

## Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта
Архитектура проекта построена по паттерну **MVP (Model-View-Presenter)** , что обеспечивает четкое разделение ответственности между 
классами слоя Model и View , где каждый класс выполняет свою роль.

Model - хранит и обрабатывает данные, полученные от пользователя или сервера.

View - отображает интерфейс для взаимодействия с пользователем, отлавливает и сообщает о произошедших событиях.

Presenter - представлен корневым файлом index.ts, где инстанцируются нужные для работы приложения классы и обеспечивается взаимодействие между слоями.

EventEmitter - сервисный класс, который используется для организации взаимодействия между классами слоя VIEW и слоя MODEL в презентере.

### Базовые классы

### Класс Api

**Свойства:**
readonly baseUrl: string;
protected options: RequestInit;

**Конструктор:**
constructor(baseUrl: string, options: RequestInit = {})

**Методы:**
- handleResponse(response: Response): Promise<object> - обработчик ответа сервера.
- get(uri: string) - принимает изменяющеюся часть url-адреса, возвращает ответ от сервера. 
- post(uri: string, data: object, method: ApiPostMethods = 'POST') - принимает изменяющеюся часть url-адреса, принимает данные в виде объекта для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'. 

### Класс EventEmitter

Отвечает за обмен событиями между компонентами.

**Методы:**
- on - Устанавливает обработчик на событие.
- off - Удаляет обработчик события.
- emit - Инициирует событие с данными.
- onAll - для подписки на все события.
- offAll - для сброса всех подписчиков.
- trigger - генерирует конкретное событие с конкретными аргументами.

### Класс Component

Базовый абстрактный класс для всех классов слоя VIEW.

**Свойства:**

- props: T - параметры для работы компонента.
- container: HTMLElement - HTML-элемент для рендера.

**Конструктор:**
protected constructor(protected readonly container: HTMLElement)

**Методы:**

- toggleClass(element: HTMLElement, className: string, force?: boolean) // Переключения класса
- protected setText(element: HTMLElement, value: unknown) // Устанавливает текстовое содержисое элемента
- protected setImage(element: HTMLImageElement, src: string, alt?: string) // Устанавливает картинку (src)
- setDisabled(element: HTMLElement, state: boolean) // Меняет статус блокировки
- protected setHidden(element: HTMLElement) // Скрывает элемент
- protected setVisible(element: HTMLElement) // Показывает элемент
- render(data?: Partial<T>): HTMLElement // Возвращает корневой DOM-элемент  

### Класс LarekApi
Предназначен для передачи и получения данных от сервера. Не относится к классу слоя MODEL, но используется как сервисный класс.

**Методы:**

- getListProductCard — получает массив объектов (карточек) с сервера.
- postOrderLot — получает ответ от сервера по сделанному/отправленному заказу.

### Классы Model

#### Класс BasketModel
Хранит и работает с данными, полученными от пользователя.

**Методы:**

- getCounter — возвращает количество товаров в корзине.
- getSumAllProducts — считает и возвращает сумму всех товаров в корзине.
- setSelectedCard — добавляет товар в корзину.
- deleteCardToBasket — удаляет товар из корзины.
- clearBasketProducts — очищает/удаляет все товары из корзины.

#### Класс DataModel
Принимает и хранит данные продуктов, полученные с сервера.

**Свойства:**

- items: Product[] - список товаров в корзине.
- total: number - общая сумма товаров.
- preview: Product | null - данные для отображения выбранного товара.

**Методы:**

- getCounter() - возвращает количество товаров в корзине.
- getTotal() - возвращает сумму всех товаров в корзине.
- setPreview(product: Product) - устанавливает данные для превью.

**Конструктор:**

constructor(protected events: IEvents)

#### Класс FormModel
Хранит данные, введенные пользователем в форму.

**Методы:**

- setOrderAddress(address: string) - сохраняет адрес пользователя.
- validateOrder() - проверяет введенные данные заказа.
- setOrderData(data: { phone: string, email: string }) - сохраняет контактные данные пользователя.
- validateContacts() - проверяет корректность контактных данных.
- getOrderLot() - возвращает данные заказа.

### Классы View
Позволяют отображать элементы страницы с полученными данными и взаимодействовать с пользователем.

#### Класс Basket
Управляет отображением корзины.

**Методы:**

- render(items: Product[], total: number) - рендерит корзину с товарами.
- update(items: Product[], total: number) - обновляет корзину.

#### Класс BasketItem
Управляет отображением элементов (продуктов) в корзине.

**Метод:**

- setPrice(price: number) - устанавливает цену товара в корзине.

### Класс Card
Управляет отображением карточки товара.

**Методы:**

- setText(element: HTMLElement, text: string) - устанавливает текст для элемента.
- cardCategory(category: string) - добавляет класс категории товара.
- setPrice(price: number) - отображает цену товара.

#### Класс CardPreview
Наследуется от класса Card, управляет отображением подробного описания карточки товара в превью и позволяет добавить карточку в корзину.

**Метод:**

- notSale() — блокирует покупку товара без цены.

### Класс FormOrder
Управляет отображением содержимого модального окна и позволяет принять от пользователя метод оплаты и адрес.

**Метод:**

- paymentSelection — устанавливает обводку вокруг выбранного метода оплаты.

### Класс FormContacts
Управляет отображением содержимого модального окна и позволяет принять от пользователя номер телефона и Email.

#### Класс Modal
Управляет отображением модальных окон.

**Методы:**

- open() — отображает модальное окно.
- close() — закрывает модальное окно.

#### Класс Success
Используется для отобажения модального окна с сообщением о том, что операция прошла успешно.